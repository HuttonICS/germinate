<!DOCTYPE html>
<!--
  ~  Copyright 2018 Information and Computational Sciences,
  ~  The James Hutton Institute.
  ~
  ~  Licensed under the Apache License, Version 2.0 (the "License");
  ~  you may not use this file except in compliance with the License.
  ~  You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~  Unless required by applicable law or agreed to in writing, software
  ~  distributed under the License is distributed on an "AS IS" BASIS,
  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~  See the License for the specific language governing permissions and
  ~  limitations under the License.
  -->

<meta charset="utf-8">
<style>
	.dot {
	}

	.dot:hover {
		cursor: pointer;
	}


	.axis path,
	.axis line {
		fill: none;
		stroke: #000;
		shape-rendering: crispEdges;
	}
	
	.d3-tooltip {
		line-height: 1;
		font-weight: bold;
		padding: 12px;
		background: rgba(0, 0, 0, 0.8);
		color: #fff;
		pointer-events: none !important;
		text-align: center;
	}
	
	.d3-tooltip:after {
		box-sizing: border-box;
		display: inline;
		font-size: 10px;
		width: 100%;
		line-height: 1;
		color: rgba(0, 0, 0, 0.8);
		position: absolute;
		content: "\25BC";
		text-align: center;
		margin: -1px 0 0 0;
		top: 100%;
		left: 0;
	}

	.lasso path {
		stroke: rgb(80, 80, 80);
		stroke-width: 2px;
	}

	.lasso .drawn {
		fill-opacity: .05;
	}

	.lasso .loop_close {
		fill: none;
		stroke-dasharray: 4, 4;
	}

	.lasso .origin {
		fill: #3399FF;
		fill-opacity: .5;
	}

	.not_possible {
		fill: rgb(200, 200, 200);
	}

	.possible {
		fill: #EC888C;
	}

	.selected {
	}
</style>

<body>
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="../jquery-2.1.4.min.js"></script>
	<script src="d3-scatter-plot.js"></script>
	<script src="d3-tip.js"></script>
	<script src="d3-lasso.js"></script>
	<script src="d3-legend.js"></script>
	<script>
		var margin = {
				top: 10,
				right: 30,
				bottom: 30,
				left: 30
			},
			width = 960 - margin.left - margin.right,
			height = 500 - margin.top - margin.bottom;

		var xAxisTitle = "Ear height [cm]";
		var yAxisTitle = "Ear width [cm]";

		var color = d3.scale.ordinal()
			.range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56", "#d0743c", "#ff8c00"]);

		var formatDate = d3.time.format("%Y");

		d3.xhr("d3-scatter-plot.txt").get(function (err, response) {
			var dirtyTsv = response.responseText;
			var firstEOL = dirtyTsv.indexOf('\n');
			var parsedTsv = d3.tsv.parse(dirtyTsv.substring(firstEOL + 1)); // Remove the first row (Helium header)

			d3.select("body")
				.datum(parsedTsv)
				.call(scatterPlot()
					.margin(margin)
					.width(width)
					.height(height)
					.x(function (d) {
						return parseFloat(d[xAxisTitle]);
					})
					.y(function (d) {
						return parseFloat(d[yAxisTitle]);
					})
					.colorKey(function (d) {
						return null;
					})
					.id(function (d) {
						return d.dbId;
					})
					.itemName(function (d) {
						return d.name;
					})
					.tooltip(function (d) {
						return d.name + "<br/>(" + d[xAxisTitle] + ", " + d[yAxisTitle] + ")";
					})
					.onClick(function (d) {
					})
					.color(color)
					.tooltipStyle("d3-tooltip")
					.axisStyle("axis")
					.dotStyle("dot")
					.showDistribution(true)
					.lassoConfig({
						"possibleStyle": "possible",
						"notPossibleStyle": "not_possible",
						"selectedStyle": "selected"
					})
					.xLabel(xAxisTitle)
					.yLabel(yAxisTitle));
		});
	</script>