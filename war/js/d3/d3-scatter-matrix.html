<!DOCTYPE html>
<!--
  ~  Copyright 2018 Information and Computational Sciences,
  ~  The James Hutton Institute.
  ~
  ~  Licensed under the Apache License, Version 2.0 (the "License");
  ~  you may not use this file except in compliance with the License.
  ~  You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~  Unless required by applicable law or agreed to in writing, software
  ~  distributed under the License is distributed on an "AS IS" BASIS,
  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~  See the License for the specific language governing permissions and
  ~  limitations under the License.
  -->

<meta charset="utf-8">
<style>
	.axis,
	.frame {
		shape-rendering: crispEdges;
	}

	.axis line {
		stroke: #ddd;
	}

	.axis path {
		display: none;
	}

	.frame {
		fill: none;
		stroke: #aaa;
	}

	.dot {
		fill-opacity: .7;
	}

	.dot.hidden {
		fill: #ccc !important;
	}

	.extent {
		fill: #000;
		fill-opacity: .125;
		stroke: #fff;

	
	.d3-tooltip {
		line-height: 1;
		font-weight: bold;
		padding: 12px;
		background: rgba(0, 0, 0, 0.8);
		color: #fff;
		pointer-events: none !important;
		text-align: center;
	}
	
	.d3-tooltip:after {
		box-sizing: border-box;
		display: inline;
		font-size: 10px;
		width: 100%;
		line-height: 1;
		color: rgba(0, 0, 0, 0.8);
		position: absolute;
		content: "\25BC";
		text-align: center;
		margin: -1px 0 0 0;
		top: 100%;
		left: 0;
	}
</style>

<body>
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="../jquery-2.1.4.min.js"></script>
	<script src="d3-scatter-matrix.js"></script>
	<script src="d3-tip.js"></script>
	<script src="d3-lasso.js"></script>
	<script src="d3-legend.js"></script>
	<script>
		var margin = {
				top: 30,
				right: 30,
				bottom: 30,
				left: 30
			},
			width = 960 - margin.left - margin.right,
			height = 500 - margin.top - margin.bottom;

		var color = d3.scale.ordinal()
			.range(["#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56", "#d0743c", "#ff8c00"]);

		d3.xhr("d3-scatter-matrix.txt").get(function (err, response) {
			var dirtyTsv = response.responseText;
			var firstEOL = dirtyTsv.indexOf('\n');
			var parsedTsv = d3.tsv.parse(dirtyTsv.substring(firstEOL + 1)); // Remove the first row (Helium header)

			d3.select("body")
				.datum(parsedTsv)
				.call(scatterMatrix()
					.margin(margin)
					.width(width)
					.padding(15)
					.colorKey(function (d) {
						return d.treatments_description;
					})
					.tooltip(function (d) {
						return d.name + "<br/>" + d.treatments_description + "<br/>(" + d.xValue + ", " + d.yValue + ")";
					})
					.dotStyle("dot")
					.radius(2)
					.axisStyle("axis")
					.hiddenStyle("hidden")
					.frameStyle("frame")
					.tooltipStyle("d3-tooltip")
					.xTickFormat(d3.format(".2s"))
					.yTickFormat(d3.format(".2s"))
					.idColumn("dbId")
					.ignoreColumns(["general_identifier", "dataset_name", "dataset_version", "license_name", "treatments_description", "name", "location_name", "year"])
					.color(color));
				});
	</script>